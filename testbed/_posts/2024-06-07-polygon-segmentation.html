---
title: "Polygon segmentations"
layout: post
hashtag: "#geometry #deep-learning #graph-neural-network #link-prediction"
comment: true
splitter: 2
featured: true
thumbnail: /img/polygon-segmentation-thumbnail-1.png
---

<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<style>
    .mjx-chtml {
        font-size: 100% !important; /* Adjust the size as needed */
    }
</style>

<div id="toc"></div>

<h3>Objective</h3>
<div class="article">

    In the early stages of architectural design, there is a concept about the <code>axis</code> in which direction the building will be placed.
    This plays an important role in determining the optimal layout considering the functionality, aesthetics, and environmental conditions of the building.
    The goal of this project is to develop a segmenter that can determine how many axes a given 2D polygon should be segmented into and how to make those segmentations. 
    <br><br>
    
    <figure style="display: flex;">
        <img src="/img/polygon-segmentation-0.png" width="45%">
        <img src="/img/polygon-segmentation-1.png" width="45%">
    </figure>
    
    <figure style="display: flex;">
        <img src="/img/polygon-segmentation-3.png" width="45%">
        <img src="/img/polygon-segmentation-2.png" width="45%">
    </figure>

    <figcaption>
        Segmented lands by a human architect
    </figcaption><br><br>

    The figures above are imaginary dividing lines arbitrarily set by the architect. The apartments in the figures are placed based on segmented polygons.
    Human architects <code>intuitively know</code> how many axes a given 2D polygon should be segmented into and how to create these segmentations, but explaining this intuition to a computer is difficult.

    <br><br>

    To achieve this, I will use a combination of deep learning and graph theory. 
    In the graph, each point of the polygon will be a node and the connections between points will be edges.
    Based on this concept, I will implement a GNN-based model, which will learn how to optimally segment given polygons.

    <!--break-->

</div>
<br><br>

<h3>A simple understanding of graph and GNN</h3>
<div class="article">

    Before generating data, let's understand graphs and Graph Neural Networks.
    Basically, the graph is defined \( G = (V, E) \). At this expression, \( V \) is the set of vertices (nodes) and \( E \) is the set of edges.

    <br><br>

    Graphs are mainly expressed as an <code>adjacency matrix</code>. When the number of points is \( n \), the size of the adjacency matrix \( A \) is \( n \times n \). 
    When dealing with a graph in machine learning, it is expressed as a feature matrix depicting the characteristics of points. When the number of features is \( f \), the dimension of the feature matrix \( X \) is \( n \times f \).

    <figure>
        <img src="/img/polygon-segmentation-4.png" width="90%">
        <figcaption>
            <a href="https://medium.com/watcha/gnn-%EC%86%8C%EA%B0%9C-%EA%B8%B0%EC%B4%88%EB%B6%80%ED%84%B0-%EB%85%BC%EB%AC%B8%EA%B9%8C%EC%A7%80-96567b783479">Understanding of the graph expression</a> <br>
            In this figure, \( n = 4 \), \( f = 3 \) <br> 
            \( A = n \times n = 4 \times 4 \) <br>
            \( X = n \times f = 4 \times 3 \).
        </figcaption>
    </figure><br><br>

    <code>Graphs</code> are used in various fields to represent data, and they are useful when teaching geometry to deep learning models for the following reasons:
    
    <ul style="padding-left: 2em;">
        <li class="decimal"><b>Representing Complex Structures Simply</b>: Graphs effectively represent complex structures and relationships, making them suitable for modeling various forms of geometric data.</li>
        <li class="decimal"><b>Flexibility</b>: Graphs can accommodate varying numbers of nodes and edges, making them advantageous when dealing with objects of diverse shapes and sizes.</li>
    </ul>

    <br><br>

    <code>Graph Neural Networks (GNN)</code> is a type of neural network designed to operate on graph structures. 
    Unlike traditional neural networks, which work on fixed-size inputs like vectors or matrices, GNNs can handle graph-structured data with variable size and connectivity. 
    This makes GNNs particularly suitable for tasks where relationships are important, such as social networks, <code>geometries</code>, etc. 
    It primarily use connections and the states of neighboring nodes to update (learn) the state of each node (<a href="https://process-mining.tistory.com/164">Message Passing</a>). 
    Predictions are then made based on the final states. This final state is generally referred to as the <code>node embedding</code> (or I think also <code>encoding</code> is right because raw features of nodes are changed to other representations).

    <br><br>

    There are various methods for Message Passing, but since this task will be dealing with geometry, let's focus on models based on <code>Spatial Convolutionan Network</code>. 
    This method is known to be suitable for representing data with important geometric and spatial structures.
    GNNs using Spatial Convolutional Network enable each node to integrate information from neighboring nodes, allowing for a more accurate understanding of local characteristics. 
    Through this, the model can better comprehend the complex shapes and features of geometry.

    <figure>
        <img src="/img/polygon-segmentation-5.png" width="90%">
        <figcaption>
            Convolution operations<br>
            From the left, <a href="https://arxiv.org/abs/1901.00596">2D Convolution · Graph Convolution</a>
        </figcaption>
    </figure><br><br>

    The idea of a Spatial Convolutional Network (SCN) is similar to that of a Convolutional Neural Network (CNN). An image can be transformed into a <code>grid-shaped graph</code>.

    <br><br>

    CNN processes images by using filters to combine the surrounding pixels of a central pixel. 
    <code>SCN</code> extends this idea to graph structures by combining the features of neighboring connected nodes instead of neighboring pixels.

    Specifically, CNNs are useful for processing images in a regular grid structure, where the filter considers the surrounding area of each pixel to extract features. 
    In contrast, <code>SCNs</code> operate on general graph structures, combining the features of each node with those of its connected neighbors to generate <code>embeddings</code>.

</div>
<br><br>

<h3>Data preparation</h3>
<div class="article">
</div>
<br><br>

<h3>Modeling</h3>
<div class="article">
</div>
<br><br>

<h3>Limitations and future works</h3>
<div class="article">

    <!-- CNN 모델과의 비교. CNN + GNN 모델 결합 -->
</div>
<br><br>

<h3>References</h3>
<div class="article">

    <ul>
        <li><a href="https://pytorch-geometric.readthedocs.io/en/latest/">https://pytorch-geometric.readthedocs.io/en/latest/</a></li>
        <li><a href="https://en.wikipedia.org/wiki/Graph_theory/">https://en.wikipedia.org/wiki/Graph_theory/</a></li>
        <li><a href="https://mathworld.wolfram.com/AdjacencyMatrix.html/">https://mathworld.wolfram.com/AdjacencyMatrix.html/</a></li>
        <li><a href="https://process-mining.tistory.com/164">https://process-mining.tistory.com/164</a></li>
        <li><a href="https://medium.com/watcha/gnn-%EC%86%8C%EA%B0%9C-%EA%B8%B0%EC%B4%88%EB%B6%80%ED%84%B0-%EB%85%BC%EB%AC%B8%EA%B9%8C%EC%A7%80-96567b783479/">https://medium.com/watcha/gnn-%EC%86%8C%EA%B0%9C-%EA%B8%B0%EC%B4%88%EB%B6%80%ED%84%B0-%EB%85%BC%EB%AC%B8%EA%B9%8C%EC%A7%80-96567b783479/</a></li>
    </ul>
    
</div><br><br>